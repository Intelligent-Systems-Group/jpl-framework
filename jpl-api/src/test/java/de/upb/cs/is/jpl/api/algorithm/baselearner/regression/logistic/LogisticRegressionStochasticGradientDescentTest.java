package de.upb.cs.is.jpl.api.algorithm.baselearner.regression.logistic;


import static org.junit.Assert.fail;

import java.io.File;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.junit.Assert;
import org.junit.Before;

import com.google.gson.JsonObject;

import de.upb.cs.is.jpl.api.algorithm.ITrainableAlgorithm;
import de.upb.cs.is.jpl.api.algorithm.baselearner.dataset.BaselearnerDataset;
import de.upb.cs.is.jpl.api.algorithm.baselearner.regression.ARegressionUnitTest;
import de.upb.cs.is.jpl.api.algorithm.optimization.gradientdescent.gradientstep.adam.AdamGradientStep;
import de.upb.cs.is.jpl.api.algorithm.optimization.gradientdescent.stochastic.StochasticGradientDescent;
import de.upb.cs.is.jpl.api.configuration.logging.LoggingConfiguration;
import de.upb.cs.is.jpl.api.dataset.DatasetFile;
import de.upb.cs.is.jpl.api.dataset.IDataset;
import de.upb.cs.is.jpl.api.dataset.defaultdataset.absolute.DefaultAbsoluteDatasetParser;
import de.upb.cs.is.jpl.api.dataset.defaultdataset.relative.Ranking;
import de.upb.cs.is.jpl.api.dataset.labelranking.LabelRankingDataset;
import de.upb.cs.is.jpl.api.dataset.labelranking.LabelRankingDatasetParser;
import de.upb.cs.is.jpl.api.exception.configuration.json.JsonParsingFailedException;
import de.upb.cs.is.jpl.api.exception.dataset.ParsingFailedException;
import de.upb.cs.is.jpl.api.math.RandomGenerator;
import de.upb.cs.is.jpl.api.util.CollectionsUtils;
import de.upb.cs.is.jpl.api.util.JsonUtils;
import de.upb.cs.is.jpl.api.util.TestUtils;
import de.upb.cs.is.jpl.api.util.datastructure.NullType;
import de.upb.cs.is.jpl.api.util.datastructure.Pair;


/**
 * This test tests the {@link StochasticGradientDescent} as a gradient descent method for logistic
 * regression using the {@link AdamGradientStep} as a gradient step update. The test is done by
 * creating a {@link BaselearnerDataset} from a {@link LabelRankingDataset} and comparing the output
 * of {@link StochasticGradientDescent} against the output of the implementation of logistic
 * regression of WEKA.
 * 
 * @author Alexander Hetzer
 *
 */
public class LogisticRegressionStochasticGradientDescentTest extends ARegressionUnitTest<double[], NullType, Double> {

   private static final String REFLECTION_ERROR_UNKNOWN_GRADIENT_DESCENT_IDENTIFIER = "ERROR_UNKNOWN_GRADIENT_DESCENT_IDENTIFIER";

   private static final String ERROR_DURING_CONSTRUCTION_OF_CORRECT_DATASETS = "Error during construction of correct datasets.";
   private static final String ERROR_OBTAINING_WRONG_PARAMETERS = "Could not obtain the list of wrong parameters due to an error concerning reflection.";
   private static final String ERROR_OBTAINING_RIGHT_PARAMETERS = "Could not obtain the list of right parameters due to an error concerning reflection.";

   private static final String WRONG_GRADIENT_DESCENT_IDENTIFIER = "blubb";

   private static final String FILE_NAME_WRONG_PARAMETERS = "wrong_parameters.json";
   private static final String FILE_NAME_RIGHT_PARAMETERS = "right_parameters_extended.json";

   private static final String CONFIGURATION_PARAMETER_LEARNING_RATE = "learning_rate";

   private static final String WRONG_DATASET_FILE_NAME = "wrongDataset.gprf";
   private static final String LABEL_RANKING_SOURCE_DATASET_FILE_NAME = "dtt.gprf";

   private static final String RESOURCE_DIRECTORY_LEVEL = "logistic" + File.separator;

   /** This delta is used instead of the one of the {@link TestUtils} as that is to restrictive. */
   private final static double DOUBLE_DELTA = 0.15;
   private static final int RANDOM_SEED = 1234;

   private static final Double[] correctPredictions = { 0.5308259955972268, 0.6087078132344194, 0.5725876149275283, 0.5688855918386857,
         0.5755631671349852, 0.6076098780287973, 0.5949394159845282, 0.6073395334221746, 0.5742933977719574, 0.5717888935213081,
         0.6042270311358484, 0.5636885544109596, 0.5791625970446453, 0.5660391031581778, 0.5786980593787483, 0.6074740495934697,
         0.6607816671955906, 0.6487885641343182, 0.5718152759696159, 0.5553053417582526, 0.5543636559018907, 0.5334170381349076,
         0.5105119428468019, 0.5916114053341156, 0.5851551462184881, 0.600747913508151, 0.6531348751070573, 0.5292865560636262,
         0.5988183237076216, 0.6050097333514322, 0.7274690719982126, 0.5085484905068434, 0.5731696154720255, 0.5518604291743281,
         0.7346298290929402, 0.5355455515616551, 0.5731360715338172, 0.5837068157452869, 0.5156145384081332, 0.5888658118737121,
         0.5904484714032762, 0.5692407659414412, 0.5061856415547272, 0.5583704123082425, 0.5903529259179623, 0.6029332942907057,
         0.6825319333817061, 0.584388093006652, 0.5897326579532599, 0.548406161856291, 0.6424538951507888, 0.7169630215202648,
         0.582411048071566, 0.6497912169905068, 0.5795965701309541, 0.5651794592943674, 0.5691829052552629, 0.5698953574216981,
         0.6089548770166004, 0.6927673602618547, 0.5624576503510138, 0.6341288968030808, 0.4965819326883708, 0.5717479925990828,
         0.5597625211203812, 0.5844321138592986, 0.5878564474390966, 0.5773846974755116, 0.6307044915574108, 0.5062081719890897,
         0.5417370288572676, 0.5782278499960299, 0.5649495291042935, 0.4839394763777824, 0.6109408978636127, 0.5160840048529768,
         0.5724042188821302, 0.656509382440172, 0.6377576421855353, 0.5265659761546709, 0.5790272758627033, 0.6256696827234367,
         0.605574084206338, 0.6310491831213717, 0.5837014778493634, 0.655938748413784, 0.6153097303673474, 0.6508758734046602,
         0.3862706136104725, 0.5644038127964741, 0.4970912032064478, 0.6057789536874049, 0.48894595127834156, 0.5524928705188387,
         0.5816455532571718, 0.5013874430600588, 0.6378759738905518, 0.5846730557528341, 0.5939166592747601, 0.5770073047060417,
         0.5785000238518736, 0.5042308572256082, 0.5718704967416477, 0.5127266877981416, 0.56552465489273, 0.6452002738382924,
         0.5955286380399097, 0.6780506608133966, 0.5524688112364222, 0.502889975467237, 0.5869283292557116, 0.5207587060818606,
         0.5132987908446284, 0.5739442313359308, 0.6195884841533595, 0.6347214758977214, 0.5328395511077411, 0.5467193203184281,
         0.6063994972786303, 0.5744521358482805, 0.49138115649623665, 0.5916603478068817, 0.6036163243596895, 0.4913173043956181,
         0.49854303113047294, 0.6035207141704484, 0.6485969470339442, 0.5052836747740498, 0.5718874897216765, 0.5561590753256888,
         0.6098587343852969, 0.6130125683090661, 0.5656769690159219, 0.5895876658668129, 0.6497912169905068, 0.5749242943932164,
         0.5973450819253557, 0.6572916113693387, 0.565484682987267, 0.5571176722261393, 0.5188073024241266, 0.7717872470968572,
         0.5772897948980877, 0.5780364666263029, 0.5850994763305056, 0.7199697314850939, 0.6072844527927012, 0.6582413778805327,
         0.5551511696396603, 0.5568743154705343, 0.48503691888861294, 0.6756509333796769, 0.5899495682627854, 0.5597111442936064,
         0.6764480205379819, 0.5400743589178573, 0.595042819559345, 0.5722848569565744, 0.6964626537822476, 0.6189562205137347,
         0.6072012710263347, 0.7069326504782321, 0.48371413981845374, 0.5869320698540624, 0.5799131179805534, 0.5851011007384611,
         0.5580705583967566, 0.6355474517098687, 0.5099186874280679, 0.5469753318697571, 0.6612327208102847, 0.6241563418751932,
         0.5417388595866062, 0.5615020659924284, 0.5702151727576169, 0.7137910633609797, 0.7048504138959536, 0.5583107420424973,
         0.5780239448112314, 0.4657902315524003, 0.6550174886609897, 0.5286796092820167, 0.616479703174172, 0.5668635649266036,
         0.6355911456707236, 0.6142825073474579, 0.7129924561939802, 0.6378149859385733, 0.6115996921160615, 0.5740067676566873,
         0.5220168167566424, 0.5799064694337193, 0.6241159125670823, 0.6035987434743095, 0.575877571754582, 0.5580154522571122,
         0.5886779837320734, 0.6426725774182603, 0.6480462437308934, 0.6072373104881842, 0.4374001559907462, 0.5551203372729301,
         0.5920474568263328, 0.534305998611793, 0.6221759641444999, 0.568713384073572, 0.5928577711560956, 0.5330582627959207,
         0.6621930154426766, 0.6078946210772468, 0.5859460485663464, 0.6558710796361195, 0.6766120843794378, 0.6114772994090536,
         0.49270143934332905, 0.7236248994471286, 0.562316591555809, 0.6614947074151672, 0.5326973490992527, 0.6183823859385438,
         0.6230560854473876, 0.5624826840921101, 0.5760043557687697, 0.6290231376768779, 0.5678963634773901, 0.6511541727379022,
         0.5894320824205788, 0.6680382823557067, 0.5280395944892736, 0.5197167011624402, 0.5841853309208439, 0.43382841699647157,
         0.5595647037366283, 0.5157072343487601, 0.59102347672959, 0.6501260117744396, 0.48940390122048893, 0.5575304442909911,
         0.6540998585474874, 0.6633249745944471, 0.5790178650551093, 0.6359321715885291, 0.5006945795994654, 0.6536380811986826,
         0.5162094351462626, 0.6851157824444812, 0.5884942275081859, 0.4797991619658539, 0.5714563968853877, 0.5355721846990398,
         0.6040077329085884, 0.6979345704654872, 0.6128327725662636, 0.6221002192074413, 0.6645354014848389, 0.684131569110614,
         0.5346189943985531, 0.5346052904640654, 0.585975129204346, 0.7112319813820578, 0.5619457574168353, 0.4654166388391941,
         0.5638212280603918, 0.6302995698599647, 0.5630597926700447, 0.592148777845744, 0.5556012728863081, 0.6221659973603413,
         0.6474514993534155, 0.4969845907551605, 0.6522341545575417, 0.5201694191741626, 0.6570211726941939, 0.5831055772658356,
         0.5842006299453794, 0.49200802090249307, 0.6645272651075611, 0.6495354164856404, 0.5523044488399013, 0.5346052904640654,
         0.5346189943985531, 0.4689318795270681, 0.6306621728129188, 0.581155611818882, 0.44210151759733385, 0.6123278451583988,
         0.6605467855852961, 0.577304450096982, 0.564587240311304, 0.5142792980571342, 0.60905316085295, 0.5260175246114324,
         0.5779130825224686, 0.5524867149225263, 0.6297728400771962, 0.5534012309419186, 0.5608965382188225, 0.5845089682441761,
         0.5758411955403031, 0.5718736325951315, 0.5672667860500993, 0.5264323347491852, 0.5679533207616742, 0.49864073515598184,
         0.6393751422915515, 0.6348640778319465, 0.5137299329470846, 0.5917659654282731, 0.6829102039206306, 0.5788022974796276,
         0.5823472726330664, 0.604242560723159, 0.5386710949521613, 0.5624707554644612, 0.5466396428903211, 0.5893891841328471,
         0.5859897458870614, 0.6026739368672569, 0.547814455851895, 0.609638615379155, 0.6011404198989027, 0.5417112236870325,
         0.5217742561854247, 0.6387272393747957, 0.5788345522985103, 0.5709826028758519, 0.6202497194764578, 0.6733044226044519,
         0.5176913172271048, 0.6207860099641851, 0.5637788881574747, 0.6329426047117783, 0.6504005734984357, 0.6719398890305478,
         0.5700436094440503, 0.6464253634199395, 0.5459925783592584, 0.5608584026955084, 0.5790242647865543, 0.5916763061978675,
         0.5421032687741821, 0.5817920515226274, 0.5755956659647313, 0.5164442172517144, 0.6329600839391437, 0.6372659090101532,
         0.5919721163979044, 0.5744089083631124, 0.6470827306038643, 0.683248179991584, 0.5808357266424673, 0.5296888675512902,
         0.6315076957065238, 0.7059629050412151, 0.6183029713723265, 0.6898554811932178, 0.7100702946575025, 0.5777709274880795,
         0.5781686181827896, 0.568905441433857, 0.5606479213229384, 0.5800633350844879, 0.5474289419469925, 0.6443878675711849,
         0.5705473338390394, 0.501589710431947, 0.6555667774909263, 0.5970544379253638, 0.5674869658828842, 0.6695612270930404,
         0.5496001190935924, 0.567878628598419, 0.5793363163266539, 0.5510537274867041, 0.5669925476043419, 0.572891376096565,
         0.6841503431015412, 0.5978693876840506, 0.5025930455000158, 0.6485249637228256, 0.5379975664411648, 0.7060581326395006,
         0.6588896104264358, 0.6862240031446372, 0.5800343015958962, 0.5727801973974891, 0.5606479213229384, 0.5790444720400999,
         0.5465012938427937, 0.6159637148936667, 0.5426735923042922, 0.5909448762951337, 0.6452914559446009, 0.6162402320624153,
         0.5019265194705322, 0.5765229278199839, 0.5420204384352003, 0.751247282218442, 0.6066989137173533, 0.6688444105453458,
         0.5525497136983855, 0.5813621697203711, 0.5748474894362248, 0.4989391360972504, 0.577464692862093, 0.530713412395386,
         0.49959332613871404, 0.5586386666053185, 0.652515909098315, 0.5706164228066954, 0.5976533669606068, 0.6452002738382924,
         0.5495099241957114, 0.5091814686053847, 0.5497824053018309, 0.5672849204935385, 0.5286720209459075, 0.6347214758977214,
         0.5920267735089039, 0.5036270682094027, 0.6723180818330907, 0.509747561018038, 0.5576117595628692, 0.5576117595628692,
         0.5636142008354166, 0.5483713904214755, 0.5461720814967228, 0.505578133223066, 0.4493358326100978, 0.5507955858381516,
         0.5734407526318374, 0.5522808745298639, 0.624326535101513, 0.5766799651726224, 0.5725492804947276, 0.6529877635421495,
         0.566291986362751, 0.4701339596106943, 0.6071711593134042, 0.4863225360883817, 0.5788321509794803, 0.7103295177933177,
         0.620454064809494, 0.5925175818897962, 0.5234252083188746, 0.6077948414310954, 0.5541787137768472, 0.6248227084463485,
         0.5725796643419585, 0.5785018301681001, 0.5831322359333908, 0.605278892411469, 0.5768283247171142, 0.4449909085774179,
         0.703430298285741, 0.6720314784956285, 0.6152022333935068, 0.47043186513196744, 0.5605933352537948, 0.675445647005863,
         0.6062076091499817, 0.5654554876562701, 0.554938826616879, 0.6043258900908312, 0.5283558603505559, 0.5476281948490022,
         0.5580616751061179, 0.6302129566420415, 0.5772636066112811, 0.6167576022795144, 0.41997633180517024, 0.6425686329391674,
         0.589949745063841, 0.49047860327695425, 0.578558982940735, 0.5486067252923057, 0.6007552885539599, 0.6997525535639731,
         0.5571050563132656, 0.6048075445730352, 0.6285037141026614, 0.5127424888959222, 0.5573674723273311, 0.6641454195916386,
         0.5780234509718672, 0.576300689125467, 0.5117735936080234, 0.5265105021340892, 0.5978697442327071, 0.6408672615714799,
         0.5752306469101496, 0.5120956441975179, 0.5233351665491657, 0.5551787158499706, 0.566821126872448, 0.549460152457842,
         0.5794496462891681, 0.538703436183557, 0.5812435366084795, 0.6689105618218567, 0.5356650502499004, 0.6594753341437627,
         0.5765010929406996, 0.5837068157452869, 0.5558387433509243, 0.621862654480778, 0.48373827498720234, 0.5835994045306168,
         0.6525865595885546, 0.5794067674494096, 0.5804396548011691, 0.6036561822659399, 0.7433159227874238, 0.47031892579411794,
         0.5581710006828546, 0.6037349589783846, 0.6379478841076959, 0.5854177539663036, 0.5733382256610486, 0.5754829168419875,
         0.5901849733266294, 0.6736584445822213, 0.6337281790383419, 0.5318165088334278, 0.5788405187360185, 0.6593058063354462,
         0.5284496202264778, 0.6340604327453953, 0.5849790165580062, 0.5454575848323892, 0.4901179778030863, 0.6002941804773549,
         0.506712857880155, 0.6149445061874802, 0.5814435359981444, 0.525815092317969, 0.6456876660455039, 0.6274829018399348,
         0.6384470359824007, 0.5316541991252532, 0.6541400277440956, 0.46908550940284033, 0.5728839881317365, 0.5469992035850646,
         0.732834985122132, 0.5413614846715887, 0.5413614846715887, 0.5373283397620311, 0.6199486462944418, 0.671336354054877,
         0.5704060396757415, 0.6196520500753092, 0.6202339430251349, 0.5562763823452125, 0.7803499579488219, 0.5570024689876896,
         0.5799099756084465, 0.542065801475753, 0.5817528271965594, 0.620087420930949, 0.5784675302959368, 0.6551599669862068,
         0.639287046548728, 0.540200069112435, 0.5563478039954122, 0.5379771248948241, 0.6329838028285145, 0.563511433899585,
         0.6177769741193474, 0.690998392467381, 0.623700314384131, 0.6044238741925191, 0.5705106459581414, 0.5914721202059603,
         0.629238063206603, 0.5016493429841167, 0.5476749432138769, 0.5787124069601427, 0.5736804087091575, 0.5685085893410742,
         0.6106200896030922, 0.5737261298329044, 0.5825714805210108, 0.5407420974047399, 0.5927284854189776, 0.557260070970892,
         0.6940772452173244, 0.6259697135848769, 0.5768623595935131, 0.6631868721430283, 0.5325581030637097, 0.594323912926433,
         0.583544185068436, 0.5758937780188227, 0.3668532258570043, 0.643161797114052, 0.5856854224864385, 0.5772029821721897,
         0.5550829476718117, 0.5877756178140066, 0.5233596772728829, 0.6898560855099795, 0.5712237136294223, 0.6067199918735571,
         0.5473906180510457, 0.5814522739327463, 0.6194873184997189, 0.5219866106545795, 0.5444319392184368, 0.6352116762296518,
         0.5723612900257236, 0.5777190162964096, 0.484204214690474, 0.5518449949471637, 0.6234542162280567, 0.5457745233373196,
         0.5413250962217481, 0.5732185486513844, 0.6175138356440886, 0.5446895609553365, 0.5788476122553429, 0.567513431109016,
         0.5103728243810596, 0.5554845596748461, 0.5775596254548054, 0.49640986025931666, 0.5251504735927633, 0.5931356596199252,
         0.5804511890864796, 0.5231876969718351, 0.5952816600942752, 0.6085694640222432, 0.5149226517677166, 0.6374351170593081,
         0.6159001099060163, 0.6243927403287489, 0.6034430397815245, 0.5730845383600512, 0.5600736303394498, 0.5223789764250134,
         0.629238063206603, 0.5854410440804783, 0.5782955672077965, 0.5854876029092377, 0.5684730543871548, 0.5648639404845708,
         0.4924747356897805, 0.5567696026769103, 0.5458120476904128, 0.6546565545940362, 0.5908151961316404, 0.5736248042788922,
         0.5938092383151513, 0.6062786937479536, 0.6733030018076445, 0.47840250895973796, 0.636642442864316, 0.5768133251353745,
         0.5401089529900038, 0.5646122268787516, 0.5888255346931314, 0.5697897365842836, 0.689535614878734, 0.6018254214459272,
         0.5925144292732459, 0.5648840086082928, 0.5789876749710277, 0.4527939941224738, 0.5657827318289608, 0.6166278486282848,
         0.6077183940077353, 0.6193308772529413, 0.6624860080094737, 0.5418495200052239, 0.6909712852949677, 0.6012042780122168,
         0.5160084427037835, 0.6303934730527007, 0.5848885633428809, 0.5066185510931518, 0.5586358804106423, 0.5793746247240216,
         0.6029268992463729, 0.4915695232149557, 0.5211251003658972, 0.594623812866328, 0.6705585433950934, 0.548903106574064,
         0.62063865528369, 0.5185814071517437, 0.5869103406104598, 0.6432852658118619, 0.5724836571622302, 0.5538983319354953,
         0.560420609483918, 0.43273935371678923, 0.6109408978636127, 0.5704271071772655, 0.6780300614165462, 0.5799545081028029,
         0.5569463512570485, 0.5768385706361358, 0.5911001651147093, 0.6105421588158542, 0.4132839897749702, 0.6310491831213717,
         0.5686838925461788, 0.56353538795669, 0.575535584656197, 0.5864790213834532, 0.5153333956983179, 0.5831428672210721,
         0.5694715622278612, 0.5644646952264083, 0.6369345784819805, 0.5685479588026119, 0.6447575863248571, 0.6117821535644214,
         0.6009510278495379, 0.7906558212975949, 0.5817140443334441, 0.5104070161668768, 0.5891720030572694, 0.5913672956264305,
         0.4980779568595898, 0.5480953567010429, 0.5783385621009182, 0.5463995521351859, 0.572749296202758, 0.5302574688248837,
         0.6033592027593806, 0.5905074184487584, 0.6844964925963358, 0.6252679815807907, 0.5350329092068216, 0.6036770181446319,
         0.5463908657388218, 0.5591101580230572, 0.5901310172019661, 0.5393870192348781, 0.5681400605616149, 0.6142787058787686,
         0.5688081189604646, 0.59169463239745, 0.6591525713156532, 0.5688689891064044, 0.704274100040843, 0.7082033777350301,
         0.528692891885008, 0.5942137996310741, 0.5850405868277426, 0.5845644898245883, 0.5841888917481463, 0.5827840671012748,
         0.5413195127719959, 0.5707989116033511, 0.6872495247514073, 0.6467630073364807, 0.5310945208620577, 0.5026123952672108,
         0.7446810736800031, 0.6505561149681427, 0.5796780079434958, 0.6192181753198559, 0.578315531122975, 0.558207134621811,
         0.6590241483753414, 0.5726751223725994, 0.5234884842688987, 0.5347938575746237, 0.6251205077751385, 0.6010552862184116,
         0.5620423755267423, 0.570213795209697, 0.541268307201411, 0.5745454269449963, 0.6310286427063311, 0.5748466810621018,
         0.5818274218435288, 0.5646084772124271, 0.5781621224652899, 0.5295061736165322, 0.546510497248484, 0.64965893521103,
         0.6406139650153159, 0.5656253947339325, 0.524542782141831, 0.5666471940106235, 0.6162619292297007, 0.583184438031756,
         0.5219709632523174, 0.5778864842591359, 0.4561316647176587, 0.701769732243711, 0.571116748115139, 0.5871969242224895,
         0.5812306600707365, 0.6461084809549348, 0.5713642889232434, 0.5210780513871437, 0.6194392205771095, 0.512248421722785,
         0.5813511312076768, 0.531416218984518, 0.6395026155052116, 0.574955964348903, 0.5863931994556537, 0.5947822858473157,
         0.6186191574642106, 0.5825276504502417, 0.692996063459834, 0.4531851803164401, 0.5808570242874745, 0.5971616274650926,
         0.5524742012725558, 0.5520226687792704, 0.527361030503448, 0.5817830446384691, 0.7269598804449815, 0.5179647207010072,
         0.5248224238048402, 0.5790619872092375, 0.5745576215531275, 0.5772551755828348, 0.5807787010239525, 0.6866014846796249,
         0.604197999183566, 0.5943060729157561, 0.6096543641694243, 0.5936458529399946, 0.5857430608459953, 0.6003794859173844,
         0.6686047923298617, 0.5151888052593897, 0.625025909501382, 0.5218693262819603, 0.5068619611598152, 0.5653209512800131,
         0.5391064341688727, 0.628914323633945, 0.5869242794486125, 0.5579942873721372, 0.5089428826496144, 0.5876560593849224,
         0.6574867251501585, 0.6564592917254053, 0.5584346855443093, 0.6214879361007511, 0.5577433162298626, 0.5722925297208659,
         0.6375582306024572, 0.7013104919412725, 0.5592512257211301, 0.7693611003217485, 0.5247041432346606, 0.6383218757904757,
         0.5573740692800982, 0.5811999732054931, 0.5762249341285021, 0.5345124946369196, 0.5724891803333301, 0.6093864942227488,
         0.5799164233010349, 0.5766144186163068, 0.581732353865999, 0.6145068014343714, 0.5393298197652305, 0.6629715995932886,
         0.5779143547131925, 0.6341703428999116, 0.6056690979724654, 0.5883685898281289, 0.572020451611938, 0.5694847481361722,
         0.5770334223504814, 0.5701266395967947, 0.6150633555593091, 0.5975642259948317, 0.5473836677651969, 0.4753605332690345,
         0.5817422439604978, 0.5738861883505515, 0.6279820259311554, 0.6078394508035465, 0.5932076848976909, 0.5924711137248944,
         0.48811526121756676, 0.6717324669397569, 0.6439750289440814, 0.57429914043751, 0.5775918680854569, 0.6038001993358542,
         0.5050510329812403, 0.5430472287551891, 0.535635870031861, 0.5352851696365653, 0.5728995077926771, 0.5857822147940055,
         0.5049206330876069, 0.6486387993032205, 0.5488203587608587, 0.6213292803802687, 0.5659936940747449, 0.6227397739589601,
         0.5817920510579291, 0.5345728030470698, 0.4825370167900226, 0.6376864551262101, 0.5334780272968943, 0.6291876302671955,
         0.5549503961492734, 0.4520915966252907, 0.5059023180295499, 0.581172485415935, 0.5850473124990613, 0.6437417573481652,
         0.6053940167383226, 0.5644910948920733, 0.5841773490589597, 0.5884436793230738, 0.6002438107098885, 0.5666370824091087,
         0.5850134087581392, 0.5426630645065584, 0.595481506267409, 0.6252623302750503, 0.409712046331405, 0.5132448377610098,
         0.5701121889650875, 0.5702792264301905, 0.5128878669095508, 0.636213591425496, 0.4207009172883168, 0.6419595712261728,
         0.6388354830778514, 0.5893685037748134, 0.6428813370870475, 0.5345675831433352, 0.5867548393030533, 0.6276938930975726,
         0.6146159225306818, 0.5990223420819532, 0.41841651073348296, 0.6051931093159552, 0.49938167048914717, 0.5761035101296966,
         0.5811575755107623, 0.5782773070019059, 0.5752340298735937, 0.6558130941857153, 0.5762121581725337, 0.5603021579030003,
         0.5379063755848623, 0.6088013180934481, 0.5633982720170381, 0.6577136652906844, 0.5788467224474168, 0.6812261691276997,
         0.5843066595729359, 0.56663078653019, 0.5794756431651168, 0.5503338337609014, 0.5074872489752311, 0.6387901953300231,
         0.5354850966284813, 0.5552306768315565, 0.44934717184238876, 0.5351565454539623, 0.6181417140507233, 0.5061247563271538,
         0.4545238058143064, 0.5698762418587733, 0.6082319180595965, 0.5507749873246938, 0.5494456100588131, 0.5604214125730824,
         0.6956756382693707, 0.6133526959303934, 0.5878708106021662, 0.5008971575859212, 0.5600925673132728, 0.6113772054993194,
         0.599909713265335, 0.6427701144367748, 0.6178116066834285, 0.5701508715998048, 0.5416555058534693, 0.5655496479624813,
         0.5825144775618841, 0.4874740500211232, 0.6690083297098915, 0.6646745968695641, 0.5450110964278247, 0.5708713447538745,
         0.6492526914108131, 0.6084293841394486, 0.46992744609589826, 0.5679013017120735, 0.650554782396364, 0.5946148048159549,
         0.5737249677699732, 0.5305100866903797, 0.5679068181950802, 0.5449944530996538, 0.5711948111022017, 0.615558699334661,
         0.578554511790188, 0.6574837709723098, 0.5785358700133685, 0.5513627724934719, 0.6650130915361202, 0.6395022267753929,
         0.5814355860360313, 0.6800056487039343, 0.536710357551439, 0.6356699309442627, 0.5706809413646914, 0.5757671354710566,
         0.5724874789035497, 0.5438755025479974, 0.6729837576641209, 0.5253115755242652, 0.6000879516787857, 0.5751527949581694,
         0.5534937416671643, 0.5249540122752915, 0.548521209037096, 0.70561134421814, 0.6573488406347093, 0.5761339878477229,
         0.5543107818756546, 0.5376545561844279, 0.5736703982277915, 0.5859062495679311, 0.5925857077035681, 0.5600038761430471,
         0.6575530127673398, 0.6154347226498821, 0.5797293027335271, 0.6446950186899304, 0.4415553167248405, 0.5661925563989846,
         0.5844917417669447, 0.5803668013103783, 0.5935782297615299, 0.6438906659519344, 0.5208431453305091, 0.6428461791597493,
         0.5959542450482949, 0.5564669624303912, 0.6191672528184264, 0.6325007748500755, 0.6108916687104285, 0.560742474535407,
         0.5591880180813947, 0.5744397777776082, 0.5911762622180615, 0.5715762055041446, 0.5872417968998555, 0.5434341832267469,
         0.5518008541555314, 0.5387814121419451, 0.4821718597557379, 0.5316414104143802, 0.6244147477480011, 0.6299658738995547,
         0.6069800166271543, 0.5574374286349242, 0.5320615541524811, 0.6271799065979631, 0.6271799065979631, 0.6093774368538798,
         0.47872503914178405, 0.5332174424024205, 0.5237907879391608, 0.5241030941106947, 0.5598776689363997, 0.5631111759476864,
         0.5726160537443784, 0.6679857982820248, 0.6261934625793882, 0.5919364823706593, 0.5292507936462374, 0.5883937064231015,
         0.5619088244084205, 0.530107099819755, 0.5456750855286677, 0.6251020919599813, 0.7338594232254443, 0.5371611120478474,
         0.5443563108328642, 0.5369576559922093, 0.5236953172457733, 0.6163800703359184, 0.5679083088303077, 0.6232026830669801,
         0.6111191432554303, 0.562283342431159, 0.6034355188205668, 0.535787057699244, 0.543288108044049, 0.5811549266845591,
         0.5622304938007758, 0.5375051825738655, 0.5859375849485128, 0.6161389277823489, 0.6147687419041171, 0.5482280615819949,
         0.5432018753531267, 0.570676721405168, 0.649240892201027, 0.6101766829625286, 0.6515534992236978, 0.5801842779231293,
         0.560789017897505, 0.5757007322065546, 0.5815047061243139, 0.4565123835500166, 0.66716203098924, 0.6689306859871637,
         0.5504309839739071, 0.630146475092271, 0.6248889889107088, 0.5765690316014999, 0.6290046486621689, 0.6160372266273652,
         0.5962696431793169, 0.753583460913988, 0.6444752366776242, 0.3908911017920478, 0.6349598334270464, 0.5879826562076532,
         0.583835047957802, 0.560067499336367, 0.6987751840862316, 0.6476060168359842, 0.7082692713083625, 0.6443057667689419,
         0.5576533478619531, 0.5898679696665732, 0.5846719022199098, 0.5663088082364255, 0.5739991764189861, 0.628998651564861,
         0.6012525127239995, 0.6041902397887826, 0.513608425060775, 0.46589409297587214, 0.7134627430387096, 0.5664908978068217,
         0.5801983235108732, 0.47536128801381655, 0.5714797240909707, 0.594623812866328, 0.4954961905711079, 0.5566080377683774,
         0.41576000550175013, 0.5549129344804011, 0.5683873254664198, 0.6999167386076314, 0.6536672876186567, 0.5445118791129467,
         0.6675749824267592, 0.5737237433156489, 0.6051935393744861, 0.6106573520912904, 0.48687530650952676, 0.6775666518699269,
         0.5793510949087772, 0.5232269281848859, 0.5934305651687773, 0.5502618058819747, 0.5706246372623371, 0.6279022439488888,
         0.5813718028178431, 0.5582203655323081, 0.5539565327829761, 0.5179847259646618, 0.5517199839928426, 0.6668902331456122,
         0.5777602008069407, 0.47346158339229455, 0.5725260020929134, 0.4857254396146944, 0.5810385417714607, 0.5900760715274233,
         0.5687592650576312, 0.5703227185575084, 0.6457442954835686, 0.5813637052317777, 0.5861970653475137, 0.6169496998500863,
         0.5368702201014238, 0.5345683011629373, 0.594526696317016, 0.5946814023176665, 0.5972756823855389, 0.5651173193802632,
         0.6510976914085377, 0.6143453671032933, 0.6425629094314161, 0.503397725002636, 0.608672024005331, 0.7042711166070906,
         0.6744118049518587, 0.5754421571209818, 0.6388895960296563, 0.5511769194278423, 0.49341898606324797, 0.6205317556466655,
         0.5808447152947825, 0.5109749967939379, 0.5099881005560299, 0.6037628103990794, 0.5174645747164872, 0.5540224382106483,
         0.6536915281660497, 0.5704118258991274, 0.5497656272352273, 0.5710724440816958, 0.6673814374668556, 0.4962884902761834,
         0.6771362779397814, 0.5264318970730807, 0.5726137711778924, 0.7158875168473775, 0.5535462558441498, 0.6033918237256516,
         0.5396713426731702, 0.5673194460819833, 0.5472274657500534, 0.4963224076198815, 0.6014133001705412, 0.5978884698126804,
         0.5521553892345767, 0.5700136551645225, 0.5470828876515759, 0.5730763888532536, 0.5277818076763402, 0.6378614756005251,
         0.6817956709956845, 0.5788292189482321, 0.5540923777813299, 0.5858266347791946, 0.5838735310955908, 0.5018351356729586,
         0.5859467655095302, 0.6882522472578084, 0.5954835822849509, 0.6239490038445441, 0.5856434368225863, 0.5855018716460071,
         0.5285050340963388, 0.6796205461422418, 0.579011015414964, 0.5104746615384445, 0.558754718162694, 0.6421462061854362,
         0.5823908347566228, 0.5632513683373596, 0.5493143889425479, 0.549898134566303, 0.5936141358612314, 0.5976445414505898,
         0.5182393826694607, 0.5549572440626869, 0.5728440639753821, 0.47669955190101476, 0.5830284862315984, 0.559884008002098,
         0.4535075092564247, 0.5776675961834328, 0.5743158167672657, 0.6010800512650741, 0.5793204254638634, 0.6225611270951376,
         0.5991066044422931, 0.5296505054510281, 0.7020334390403657, 0.6331028364782512, 0.5616309844824335, 0.6216151433673619,
         0.6735129009671846, 0.5710363578049422, 0.5723541910559334, 0.6749007968950551, 0.7087779722354024, 0.5558054908199179,
         0.5582187143657488, 0.6623968175219876, 0.6354155097924344, 0.6571705992828839, 0.6184750065264415, 0.584288182236689,
         0.5839157001478341, 0.5920411400413123, 0.5770993672788962, 0.6618213203918113, 0.6102605635868329, 0.6936401174144237,
         0.41998669208936296, 0.5427364810441075, 0.5389236150344155, 0.5640708102098556, 0.5534342239156669, 0.5774551275213492,
         0.5977920429602391, 0.698256810283588, 0.5628608298435936, 0.4853501408105023, 0.6422505031415484, 0.5966120544330892,
         0.6278649005608294, 0.5994205841082775, 0.5709102113379456, 0.5447240260931552, 0.5746042297072195, 0.6115467850729397,
         0.5739256761924235, 0.5444974118186326, 0.5621915514048318, 0.7755201938030956, 0.5892509294220188, 0.6027533318545941,
         0.6075380640999962, 0.5596522145235521, 0.541585194744798, 0.5692044968947707, 0.5874869120318019, 0.554641598088462,
         0.5403842166660516, 0.6516467084691124, 0.6676413549071183, 0.5887628215544406, 0.5903549661645179, 0.7273915390096901,
         0.6900805345562009, 0.6448572781825507, 0.5706003910119543, 0.579519966311964, 0.5598968223573403, 0.5521514788696466,
         0.5921747405780876, 0.5181507841585428, 0.5681271122538737, 0.5747494658088739, 0.6783132357776122, 0.5249373200782553,
         0.5727338663016959, 0.5668296693427647, 0.558559752813509, 0.4596058703356451, 0.5343014092854307, 0.6428894916029866,
         0.5841047434282605, 0.508883426494933, 0.6868077487835018, 0.5419003054887389, 0.5767860676172841, 0.5959261179068985,
         0.6290046486621689, 0.5100312331917629, 0.5993127294689171, 0.5100212561971762, 0.7502935906573338, 0.5338007224238867,
         0.5671914168154031, 0.4718216552176166, 0.6153551400156381, 0.6441290437510186, 0.5996428265245901, 0.5599610317554163,
         0.6365004520863169, 0.586078699603793, 0.6656211677884811, 0.5676632949468201, 0.5739490355092379, 0.588846073836356,
         0.546317750137181, 0.633604171177341, 0.5874451932036857, 0.5034435179801634, 0.6267449859089258, 0.6280852194360181,
         0.5327472494344339, 0.5727993274991935, 0.6095719142329507, 0.494574354559599, 0.5853871714926324, 0.5074988867444845,
         0.555002714091008, 0.5677225208239316, 0.6683298416978078, 0.5698265966518472, 0.5006620902922204, 0.582546362958135,
         0.6292783275253954, 0.5956896798824189, 0.6917650216807857, 0.5643281937463429, 0.6059096579527812, 0.6447933425748391,
         0.5733154687582137, 0.6147059295417518, 0.6212422740497412, 0.5889658563637755, 0.5602252609834225, 0.5597647265087159,
         0.6282820104908567, 0.5689237864762268, 0.6019801201977171, 0.555397083240656, 0.5336522647361893, 0.5116988370258246,
         0.6608143335269826, 0.6487359884516641, 0.6194830833010884, 0.5375331165670924, 0.5858479250282298, 0.556331491010887,
         0.6421617593707354, 0.4189557212155974, 0.5648211427591047, 0.6861874601804968, 0.5754808776981588, 0.58803755614078,
         0.5642588328502645, 0.575216040132952, 0.786233714945189, 0.6928651987484888, 0.5780177115919841, 0.6193171762544797,
         0.5370160529432487, 0.5476915241357728, 0.4810244254847192, 0.6363323851916726, 0.6752144477829705, 0.5886565365026347,
         0.5782733195330008, 0.6199840185969694, 0.6591436812580709, 0.6184540856858326, 0.601574419353416, 0.7228913226026438,
         0.5532921824380744, 0.6128538723367578, 0.6750961534889002, 0.5574509081399306, 0.5935190305826443, 0.5688202804332535,
         0.49493689699560584, 0.5703699273456871, 0.5951512255318471, 0.582101700119984, 0.5649288843602396, 0.5655743050531358,
         0.5346613524136993, 0.5745062868902294, 0.6538851267095501, 0.5692751116525747, 0.5401993936313172, 0.589767795314767,
         0.5374245218487125, 0.563059409131178, 0.6401761422659565, 0.5807388508798107, 0.6018084829287436, 0.618685647237119,
         0.6357855261554415, 0.5745807734982785, 0.5792831702714074, 0.6647009967415487, 0.6485468091959374, 0.5323611063472886,
         0.5559999673146476, 0.6481244900170154, 0.5703814883101428, 0.6625599321522974, 0.512436857456122, 0.6091840670357784,
         0.5642691629821499, 0.5645647120682958, 0.6249106982834924, 0.48706732181965073, 0.5159680948583836, 0.5846941336860758,
         0.5228927849246479, 0.5829407109461373, 0.5319029205800838, 0.5687063155677546, 0.5810566020813368, 0.559884008002098,
         0.6983255279808721, 0.3834572307928961, 0.46845486638216405, 0.576005037412423, 0.5709892808366325, 0.56576762485567,
         0.5944313255214522, 0.5497333426788473, 0.5473236823308136, 0.6880851513592857, 0.4374139766218829, 0.6659003175195919,
         0.5214562009699057, 0.5147141518592349, 0.5725260020929134, 0.5519466954667566, 0.6386473720321545, 0.581943736107429,
         0.5053438834737031, 0.6384303773587232, 0.5736074364424507, 0.6320241296109068, 0.7318076543833006, 0.6232517490935546,
         0.5512634393815946, 0.5723317638351573, 0.5799167548957499, 0.6446009736296484, 0.5308535774157238, 0.5874837481349556,
         0.5728612284255691, 0.45355525681984094, 0.5930577296368923, 0.5735397858913687, 0.5851712128931454, 0.5722938135367763,
         0.6824316556803643, 0.6626680657025006, 0.5573513795752043, 0.5858068952408633, 0.5903460109269677, 0.6010236582450568,
         0.5614124278119437, 0.598549589838627, 0.5532798047864651, 0.5596855847826422, 0.6147536389937142, 0.5844636689943072,
         0.6392655044358005, 0.5540944811071203, 0.4974230551652398, 0.7119566594351924, 0.47541863343557533, 0.6293071685656826,
         0.5166354204331095, 0.6546755821290974, 0.5415720446797581, 0.6103101359057465, 0.6600216949863261, 0.5887460502582905,
         0.5769092758256923, 0.5398326977764916, 0.5362665061011368, 0.570240694651885, 0.6190674981256145, 0.6521888121070183,
         0.6447267968353285, 0.5200294076978923, 0.574019931222148, 0.5797874994468954, 0.5425669008837141, 0.44700942801829935,
         0.5907189041723635, 0.6087521014831239, 0.5918584712443359, 0.568191589942973, 0.6491652242694749, 0.5876958550555762,
         0.5671426534525218, 0.6336498609236927, 0.5680520379575549, 0.5915132505555338, 0.5047061915911336, 0.5239040371055701,
         0.629601643903654, 0.5848494913390466, 0.6389556698901786, 0.6454239517292869, 0.589297914195733, 0.6392848374687721,
         0.4946286242824488, 0.5830225974706152, 0.6106718880724089, 0.586911395713701, 0.6255228407654848, 0.6255228407654848,
         0.6255228407654848, 0.6255228407654848, 0.5430013910138664, 0.5672316340039006, 0.5923061255021836, 0.5786652241851024,
         0.6593000642230931, 0.6172243942975547, 0.5198046673008453, 0.5786151021471478, 0.5245581673801836, 0.6357176351047935,
         0.5792800988216013, 0.5724037598573698, 0.5804651079513287, 0.6178944259209425, 0.6284400073948159, 0.5618592929864787,
         0.530071727673726, 0.62120933111831, 0.5708873925051944, 0.5750986837303989, 0.6060041035796669, 0.6887790728091145,
         0.5543843881593493, 0.501584373543349, 0.6317527302569008, 0.4971338003529795, 0.5736167900487641, 0.6084643089160546,
         0.6159040787019401, 0.6473612067233859, 0.4498918053879269, 0.5564279907299703, 0.608869800029623, 0.5763310573071325,
         0.67631926072401, 0.569936222210978, 0.5663570994690726, 0.6322692345687668, 0.582723337010153, 0.6645320553701223,
         0.553713545451617, 0.6702540203953612, 0.6325647053373741, 0.6228142208149838, 0.5830858764769979, 0.6519240578992939,
         0.5913701547732992, 0.5072687198940927, 0.6800040064893299, 0.6670271224370741, 0.5357659728936309, 0.5873198271472696,
         0.5585349436731326, 0.6809741896570806, 0.5594225782160697, 0.746024835833159, 0.4409033029410351, 0.5830128282721758,
         0.5748560338099264, 0.5116846630770264, 0.5614533709886435, 0.5929971137393975, 0.6396090534203078, 0.5103608299683469,
         0.6356849495040603, 0.586509509307962, 0.582407021500542, 0.5341043457833253, 0.6465475545574427, 0.6364489701805593,
         0.6035117802683694, 0.6100760550542093, 0.5779933831589571, 0.6385090060462328, 0.5610211384231811, 0.571728229957605,
         0.5816275503778051, 0.5575805197046217, 0.5667739170543679, 0.6229594758933971, 0.6372467053118909, 0.5482320079727809,
         0.543821427280528, 0.5654450554535614, 0.6359639234420977, 0.6214714283323206, 0.651218206655896, 0.6383094789753317,
         0.5857803025552755, 0.5970157544579661, 0.6173619011937516, 0.5717994305336643, 0.6170158162136812, 0.5638889272912734,
         0.5302576418241486, 0.590547913837496, 0.6371285726351281, 0.5140076632104352, 0.6101193752784652, 0.589331150822813,
         0.6337119717567928, 0.5950096133177598, 0.6203341508909184, 0.6913995830926355, 0.583108852785589, 0.6127894883152444,
         0.6584610935338094, 0.5452512100069619, 0.500686881829248, 0.5241283430817076, 0.6479215913360794, 0.67757234596465,
         0.6005865310514873, 0.5963437840663189, 0.5809611259988192, 0.5243900941705218, 0.5818338061919067, 0.5445289264495529,
         0.6014785377513309, 0.5003210525047107, 0.6588265736221516, 0.5867167876051282, 0.5274333223401251, 0.5756792325024109,
         0.699946075687528, 0.5699451173445427, 0.7943398250092752, 0.5858010593038502, 0.5711817552786936, 0.4693992450489748,
         0.6961213647003677, 0.6660819843258082, 0.6522214044783476, 0.6310536293539285, 0.5710273449960312, 0.6175583683702088,
         0.5870898675206198, 0.5160718260907912, 0.5891980561227237, 0.6665816013373892, 0.6211572475010841, 0.47613456897685513,
         0.6463881264384999, 0.48535662388550277, 0.5137022563263018, 0.601137136215822, 0.6013567141144945, 0.6032812811309886,
         0.6811863973980794, 0.6235335917252612, 0.6649359611120687, 0.6744923850507559, 0.5343124467844612, 0.5217848752328045,
         0.5837544129645451, 0.5947035307076183, 0.5377743255879432, 0.6386192036278652, 0.6589689345001956, 0.5768250271912073,
         0.6144717441198196, 0.6131636073383177, 0.5547193051823867, 0.5966503985041092, 0.5175396207222901, 0.5730191381223095,
         0.4243758899039866, 0.4740355528006896, 0.5457589964647589, 0.5728827994830328, 0.5666024389082469, 0.5844500032286221,
         0.6099881654621179, 0.5794588242667262, 0.606978694569456, 0.5849031194365181, 0.5026401000702763, 0.635989507500618,
         0.5899540695323371, 0.5695758181492371, 0.6155865678662524, 0.5635875741695674, 0.5808115720956817, 0.5730598622169671,
         0.6157530433914997, 0.515890620391394, 0.5789987641900165, 0.521384892521572, 0.6186714983996308, 0.5768863806529222,
         0.582441088314798, 0.5779850079600085, 0.5813922465707373, 0.5286165773743751, 0.7247886714143088, 0.5671994369949652,
         0.5898691364346526, 0.5344578697500113, 0.49916926678900664, 0.5692172326136167, 0.62850830002988, 0.5070193799906983,
         0.4926922863226628, 0.5320929795760703, 0.5620319845319954, 0.5938255783935872, 0.6543462796687836, 0.5667274184128492,
         0.5403573879639108, 0.65536476509409, 0.5738785565857601, 0.6461784709900706, 0.5838590010985008, 0.5875936121702403,
         0.6284317592129939, 0.6053025094148056, 0.5858955466552239, 0.60348683953836, 0.4962679654931834, 0.5882523992225884,
         0.46520214739587895, 0.49832200594854553, 0.5664468486874297, 0.6102105439774305, 0.5172170294702929, 0.5892010483242036,
         0.6652375258379284, 0.5509768112845665, 0.5582576043175755, 0.562069876476952, 0.6045420517766332, 0.5345308015120361,
         0.6572875812546267, 0.5829816152828694, 0.5350869418719201, 0.5388576775065769, 0.5239754773541473, 0.5319984687149717,
         0.597105923330438, 0.5701442356776655, 0.6733900089630765, 0.6223870361283024, 0.5959168020687743, 0.7176679831791428,
         0.5727626901757742, 0.5750591497814774, 0.51699450304552, 0.6887350656480142, 0.5717650525947654, 0.5881529482465458,
         0.6361840953780445, 0.5665558497978566, 0.563414008066118, 0.6009476638813742, 0.560749047022437, 0.5528665545583309,
         0.5703418359869467, 0.5772572264463449, 0.5560885809552517, 0.6246051974480834, 0.7014968124845793, 0.6257601830843702,
         0.4998790873716983, 0.6566924520801729, 0.567032891550506, 0.5583385746059778, 0.5728989069508568, 0.665330802385761,
         0.5792230785987563, 0.4424211438622327, 0.5780582717904149, 0.5663553690276086, 0.5789646811939075, 0.46714715147068364,
         0.7415016819058567, 0.7708119831562937, 0.5591241014849021, 0.5376238108172953, 0.5922678708426259, 0.6851735688638805,
         0.5717578645344961, 0.6577896461643171, 0.4993950114658932, 0.5764439866105763, 0.5722484164022709, 0.5860672051573653,
         0.6408791663927992, 0.6364131036367574, 0.5862432053426663, 0.5831504640805948, 0.5142823864140745, 0.6091620653721607,
         0.6092983141329954, 0.6140510391657731, 0.637048076509124, 0.5621101304921076, 0.5865068933638371, 0.5822718540077401,
         0.5693769662283112, 0.5579215036154639, 0.6508351410744283, 0.5939166592747601, 0.5770073047060417, 0.5879550437945263,
         0.6450057171108333, 0.6520266187977845, 0.5332188282542081, 0.5815752200171614, 0.4714396261751601, 0.5707697860209442,
         0.572438655785527, 0.5570779006845116, 0.6064983543106905, 0.5498453756718992, 0.613421117827929, 0.5096402092058008,
         0.6623599062078743, 0.6318545718931873, 0.5031559009180785, 0.5600380265331535, 0.6440803652385737, 0.47813437840299333,
         0.612597922528544, 0.5426492989908611, 0.5842336331677717, 0.6161024637669296, 0.6295678926330063, 0.5285023367604537,
         0.577195512153213, 0.5884065902299804, 0.5535158907981457, 0.6173342158891716, 0.5616914201876014, 0.6457489696094512,
         0.5832027738172718, 0.5829641138946959, 0.5502213034746862, 0.6179179272436711, 0.5835101549352291, 0.5532235973175298,
         0.6222844991002061, 0.5497986131817625, 0.5535197413712539, 0.5642891384844706, 0.6699307611001772, 0.5118092269359164,
         0.575749542693189, 0.5027168812263513, 0.5628304072266859, 0.598653137642685, 0.5801754980621247, 0.6117941926065383,
         0.6202095171207531, 0.6161389277823489, 0.615318481644241, 0.5449421526849099, 0.5822984862350897, 0.6855441166979649,
         0.4909239562348515, 0.5971322956448009, 0.5966634086214365, 0.6178045488376321, 0.5798796294134465, 0.5561646652500647,
         0.47797672801369406, 0.5089648955393473, 0.5707429793105215, 0.5418775248958388, 0.6339160332075986, 0.5686101331420077,
         0.6070208871112006, 0.4481358182914133, 0.5809212022929059, 0.5685387915961806, 0.5039000005844633, 0.578493325280616,
         0.41091081418719577, 0.5543265237549035, 0.7602913876524949, 0.6390451964041446, 0.5769016048523146, 0.6452376230814213,
         0.5292309851319875, 0.5395886218116247, 0.5900147339871306, 0.550557129847973, 0.6121817290404618, 0.4514342461993195,
         0.7584241847399317, 0.655468923824691, 0.6731029642817089, 0.5137827464418325, 0.496824956915282, 0.5135822473905485,
         0.5338228735733708, 0.7567931371215404, 0.5798654982610355, 0.5282066736456876, 0.5117602977742205, 0.548443393531112,
         0.5348893018177473, 0.5805952560450292, 0.5370804143523388, 0.6202134863355925, 0.5589027047450091, 0.634974860413458,
         0.5538180533574835, 0.5922732337336821, 0.6608862403514112, 0.6235787481704061, 0.6094925501051353, 0.525676902053445,
         0.5358288518410033, 0.6050790033716636, 0.5277455504707169, 0.5649046124611341, 0.5801354686208539, 0.567994442746796,
         0.5503611114630625, 0.6524949950249079, 0.5418161619327493, 0.7470059978700199, 0.559330397489853, 0.555648685270428,
         0.5577762013093562, 0.5750165517660756, 0.6650846461872727, 0.6629540464061401, 0.5640735539070874, 0.5968082905129145,
         0.5685246900367659, 0.5759261597180222, 0.6016076559398725, 0.5380445726324905, 0.5695290561775129, 0.5841981551296107,
         0.5874130633868201, 0.7012209849078457, 0.581199341212832, 0.5674200639367385, 0.4950433187226149, 0.62778534985419,
         0.42075710270828787, 0.498553925792953, 0.5878833090686058, 0.5754876917568463, 0.5919338123325544, 0.5248879839143579,
         0.6368499022823366, 0.6508742263324127, 0.5431477010204638, 0.6088124912844395, 0.5918398046502292, 0.6268580046631301,
         0.5727344379791043, 0.515329780595662, 0.6778077153821198, 0.5846243122823094, 0.5722460031296431, 0.5399990469260774,
         0.4885110305177527, 0.5258121338508124, 0.5425931110311614, 0.5142194598769007, 0.4126940224711042, 0.5239158063624482,
         0.6562866893181167, 0.6430311844269697, 0.6575707568230509, 0.6315717547127673, 0.6259783685044055, 0.5718958332118523,
         0.6311070304496619, 0.5747871740142139, 0.6583098094129731, 0.65694859288267, 0.5822884245513903, 0.584646003130227,
         0.5737983062316547, 0.5431455436211107, 0.6347526667614776, 0.5413853240483523, 0.5466343843135537, 0.6268832170028371,
         0.5050866571176243, 0.5815442654714957, 0.6004650364889331, 0.5057834202820974, 0.6366703975964311, 0.5409125097040454,
         0.5310643796892172, 0.5065030118082735, 0.6374535132818876, 0.5478335944187471, 0.4485569014282021, 0.5922732337336821,
         0.660898417140314, 0.5597603413094369, 0.5471790211800408, 0.641327091930404, 0.6225884579331589, 0.6411828608117889,
         0.5949626211705831, 0.5819415089945341, 0.649678633106114, 0.5588093239543991, 0.5881128032931964, 0.5179535091408027,
         0.5160797107735652, 0.5308130548707873, 0.5538933245743898, 0.588527089315098, 0.5428568797730338, 0.5390178123399354,
         0.5743187966185911, 0.6424017836183865, 0.5102612526308421, 0.624108529591386, 0.5190903096566416, 0.5930021678403765,
         0.6035159500605125, 0.5065180267036907, 0.5610961756233891, 0.6536952801530239, 0.6168968464675637, 0.6004975687434415,
         0.6021346703505178, 0.5672414862434774, 0.6670277296590894, 0.6488287634675464, 0.5851351652726479, 0.6117416251501904,
         0.4610785542561116, 0.5538974944368259, 0.5466993224554763, 0.7245441246991448, 0.5846178093201436, 0.5621486558671818,
         0.6311033752675487, 0.5763089094323947, 0.5737600123209707, 0.5803287905454687, 0.4972491175202571, 0.5406158457846001,
         0.681939804943648, 0.5802157540413501, 0.5537362846871506, 0.5784966806446098, 0.4974431889421546, 0.5841030725506206,
         0.7269276998751075, 0.590257627845438, 0.5619604645205278, 0.5515892033745751, 0.5626364124734887, 0.5480130960046945,
         0.5675190071486997, 0.6361406678776236, 0.6253462052111929, 0.5849317787020927, 0.6181815545277257, 0.5723225641513041,
         0.6498212165850514, 0.5939784030273402, 0.5110639828814896, 0.639287046548728, 0.6259762815188284, 0.5377431153141258,
         0.5990300112977297, 0.5902529696783432, 0.6215815458625018, 0.5707684548303028, 0.5276716956864367, 0.5128397330787002,
         0.6972297693574458, 0.6047070339707373, 0.6356484901495645, 0.4947776903097995, 0.5934484865166261, 0.5734145253763377,
         0.5822823665590356, 0.6797719658767059, 0.6768398418686842, 0.5938211835818613, 0.5276750241655614, 0.4932378321593682,
         0.5262378359378677, 0.6047921024950493, 0.5922883178863787, 0.5981998576228844, 0.5836700669478726, 0.5200532460059536,
         0.5956684769171172, 0.5419635280605873, 0.6006278584741392, 0.5485156762307029, 0.5477921632011055, 0.5640666093554036,
         0.6567533495406976, 0.5500647404017039, 0.6953155330769254, 0.5014886739395845, 0.6625206984249835, 0.5903717018312064,
         0.5863363491369654, 0.5635653327361971, 0.6235143987365059, 0.5857824400596477, 0.5016619584300098, 0.5704008664112684,
         0.5830811153204887, 0.6710403838373632, 0.6016001627810382, 0.5937998554068212, 0.6820336163138602, 0.5528746937744851,
         0.5837123669996084, 0.58962270330921, 0.5712686838020999, 0.5779287118708349, 0.6388473342155045, 0.4536440557844022,
         0.5835879335168199, 0.5544505066532468, 0.73458074626716, 0.5897120298576457, 0.579383463818431, 0.6006050321881914,
         0.5507990635905966, 0.4838221379243692, 0.4328308931668315, 0.5081401052494054, 0.5466009250813578, 0.5850357982934445,
         0.469521451968322, 0.5620049116168226, 0.476515103803356, 0.6233804724898451, 0.5785784163853079, 0.5675631266520643,
         0.6284791264122522, 0.5642150534407879, 0.6205187738305628, 0.5607994396650559, 0.5746891844683614, 0.5963994024061858,
         0.5875042842225864, 0.5013419296085879, 0.5233135901946362, 0.6722713915107361, 0.4802643659009273, 0.484738865973694,
         0.543785839310413, 0.6293177218199373, 0.6339370030783025, 0.6011729108303415, 0.5148906181697591, 0.6518792636134411,
         0.48879637389687175, 0.5311011639503282, 0.5866771942986362, 0.569759288785816, 0.5742993494536004, 0.6595313219702261,
         0.6016645278885332, 0.5794235262527081, 0.49660305033351976, 0.5890375320868747, 0.5780553689790812, 0.4529645084957353,
         0.6528453165588223, 0.6798760769017207, 0.5392719415549065, 0.5661594506801666, 0.5802727031743778, 0.5780114229376472,
         0.579899119513369, 0.5930406085906147, 0.5600927886743001, 0.5488827365292153, 0.5463783976127933, 0.5723426146683226,
         0.6129675905555816, 0.5114322193895969, 0.5316492795075342, 0.6564694441348836, 0.5785686357799033, 0.5429238519691545,
         0.5494568149344203, 0.5738598277608811, 0.5878143392002577, 0.4886580015210345, 0.4267079349678004, 0.5516128850813528,
         0.5776126111292175, 0.5711975661550778, 0.6234014873404541, 0.5778096104623486, 0.7558801553939944, 0.5400822721682705,
         0.6686007985392893, 0.6147091825737496, 0.5151007298050265, 0.585347046528663, 0.7246495763477707, 0.5459546016454694,
         0.5511625614707039, 0.7047871131907293, 0.5046446542410052, 0.6072919551098632, 0.6410551376268447, 0.534424301795032,
         0.5646125487901577, 0.593654901120053, 0.6801500794416255, 0.5431164267238541, 0.616479703174172, 0.66365924934081,
         0.5759434358264952, 0.4994902785397816, 0.5746106512026246, 0.5624170447450095, 0.5849346312462542, 0.6118727147421253,
         0.5617843676773596, 0.6531053460334867, 0.5492527808731997, 0.5433829721711124, 0.5727201029856558, 0.6256790575633028,
         0.5845030783767419, 0.6002130286953119, 0.6056571922594152, 0.6305894221365881, 0.5694825608193238, 0.6799414902285539,
         0.5892491936527092, 0.4730336402860889, 0.5813984803097982, 0.6002627419206283, 0.5245615183439226, 0.5348457429561657,
         0.6477817177679381, 0.5006385829124912, 0.5732757900003865, 0.5763766180969729, 0.6782682866801624, 0.6325641478014306,
         0.5377809521325813, 0.6059494525710387, 0.5814964429462053, 0.4914836320361399, 0.5911210401335427, 0.5447763342419151,
         0.5981546857775139, 0.5879259484381033, 0.5590259507977339, 0.6530547838996812, 0.5656998007543976, 0.5188684830442635,
         0.5709687598049826, 0.6000325752187858, 0.5620319223146508, 0.6044625586739765, 0.5764998561606739, 0.6669129872001336,
         0.5530440732559851, 0.5569374569600865, 0.5741020312453772, 0.5925022436812701, 0.628914323633945, 0.6761007999607676,
         0.597039559574978, 0.5777280095344473, 0.6016634243982871, 0.589299666869631, 0.6179672203955374, 0.6399388941373589,
         0.6109951703232517, 0.6255526260184185, 0.5713813414832716, 0.5774484513524565, 0.5110423139202025, 0.7000639322309988,
         0.5350580468780777, 0.5911316103267663, 0.5774963710656705, 0.6018510401062169, 0.4802026044833387, 0.6560189021131495,
         0.6984270334282932, 0.593410672184847, 0.5832004532882822, 0.5593470848414627, 0.4340889913385742, 0.669785380129238,
         0.6288417071949605, 0.6438991446611689, 0.5472753869145628, 0.6585671619238562, 0.5573555127884126, 0.5476913463366855,
         0.3317378432985732, 0.5837444512528109, 0.6132454915921179, 0.5980411506342196, 0.575748204534531, 0.6083865864063844,
         0.6185001551465963, 0.6343252061842852, 0.5323211823739739, 0.5541550732886698, 0.5845316156737085, 0.5874245143050124,
         0.6443371000492609, 0.5730866063332917, 0.6408206946868578, 0.5718997945745072, 0.5381607787401602, 0.5604319856799342,
         0.5007553964223356, 0.4954633894778936, 0.6756509333796769, 0.6813621742830583, 0.6528777390217316, 0.617432146614203,
         0.6419595712261728, 0.6500120362779982, 0.593720457519947, 0.5011056593053557, 0.5755406183090772, 0.5765675600555448,
         0.6323646019249887, 0.5368378211845589, 0.5551563947060805, 0.5658717171353087, 0.5631842839143342, 0.5333665757462822,
         0.47039274800992964, 0.5816843180084929, 0.6558130941857153, 0.7485291793644996, 0.5947598940494127, 0.5522486021542331,
         0.5656012681924849, 0.5283654267395939, 0.7282175616218448, 0.5561678130117088, 0.6244570811806628, 0.5704211352020094,
         0.7091127231551877, 0.5295187286945553, 0.6110562315383946, 0.5205140352083458, 0.5838795301037404, 0.5701684044357487,
         0.6433406769908657, 0.5938569152219614, 0.5789100493906293, 0.5951118307732175, 0.5947727635027785, 0.6122479356672722,
         0.6146319962372772, 0.5826122592282689, 0.5507417706848475, 0.5837570471251017, 0.6038878249401727, 0.7322195230263717,
         0.6435957842296748, 0.5715136965625386, 0.5831389151737847, 0.5978273315820071, 0.4777590162122066, 0.6811194412453524,
         0.6393408962847145 };


   /**
    * Creates a new {@link LogisticRegressionStochasticGradientDescentTest}.
    */
   public LogisticRegressionStochasticGradientDescentTest() {
      super(RESOURCE_DIRECTORY_LEVEL);
   }


   @Override
   public ITrainableAlgorithm getTrainableAlgorithm() {
      return new LogisticRegression(new StochasticGradientDescent(new AdamGradientStep()), 0.001);
   }


   @Override
   public List<IDataset<?, ?, ?>> getWrongDatasetList() {
      List<IDataset<?, ?, ?>> wrongDatasetList = new ArrayList<>();
      wrongDatasetList
            .add(this.createDatasetOutOfFile(new DefaultAbsoluteDatasetParser(), getTestRessourcePathFor(WRONG_DATASET_FILE_NAME)));
      return wrongDatasetList;
   }


   @Override
   public List<IDataset<double[], NullType, Double>> getCorrectDatasetList() {
      try {
         return createTestBaseLearnerDatasets();
      } catch (ParsingFailedException e) {
         Assert.fail(ERROR_DURING_CONSTRUCTION_OF_CORRECT_DATASETS);
      }
      return null;
   }


   @Override
   public List<Pair<IDataset<double[], NullType, Double>, List<Double>>> getPredictionsForDatasetList() {
      List<Pair<IDataset<double[], NullType, Double>, List<Double>>> predictionsForDatasetList = new ArrayList<>();
      IDataset<double[], NullType, Double> correctDataset = getCorrectDatasetList().get(0);


      List<Double> correctPredictionsAsList = new ArrayList<>();
      Collections.addAll(correctPredictionsAsList, correctPredictions);
      predictionsForDatasetList.add(Pair.of(correctDataset, correctPredictionsAsList));
      return predictionsForDatasetList;
   }


   @Override
   public List<JsonObject> getCorrectParameters() {
      List<JsonObject> parameterList = new ArrayList<>();
      try {
         parameterList.add(JsonUtils.createJsonObjectFromFile(new File(getTestRessourcePathFor(FILE_NAME_RIGHT_PARAMETERS))));
      } catch (JsonParsingFailedException e) {
         fail(ERROR_OBTAINING_RIGHT_PARAMETERS);
      }
      parameterList.add(JsonUtils.createJsonObjectFromKeyAndValue(CONFIGURATION_PARAMETER_LEARNING_RATE, String.valueOf(0.1)));
      return parameterList;
   }


   @Override
   public List<Pair<String, JsonObject>> getWrongParameters() {
      List<Pair<String, JsonObject>> wrongParametersWithErrorMessages = new ArrayList<>();
      try {
         wrongParametersWithErrorMessages.add(Pair.of(
               String.format(TestUtils.getStringByReflection(LogisticRegressionConfiguration.class,
                     REFLECTION_ERROR_UNKNOWN_GRADIENT_DESCENT_IDENTIFIER), WRONG_GRADIENT_DESCENT_IDENTIFIER),
               JsonUtils.createJsonObjectFromFile(new File(getTestRessourcePathFor(FILE_NAME_WRONG_PARAMETERS)))));
      } catch (NoSuchFieldException | SecurityException | IllegalArgumentException | IllegalAccessException
            | JsonParsingFailedException e) {
         fail(ERROR_OBTAINING_WRONG_PARAMETERS);
      }
      return wrongParametersWithErrorMessages;
   }


   /**
    * Creates a list of correct {@link BaselearnerDataset}s created from a
    * {@link LabelRankingDataset}.
    * 
    * @return a list of correct {@link BaselearnerDataset}s to test on
    * 
    * @throws ParsingFailedException if an error occurs during the creation of the original
    *            {@link LabelRankingDataset}
    */
   private List<IDataset<double[], NullType, Double>> createTestBaseLearnerDatasets() throws ParsingFailedException {
      LabelRankingDataset labelRankingDataset = getLabelRankingDataset();
      int[] labels = CollectionsUtils.convertIntegerListToArray(labelRankingDataset.getCopyOfLabels());
      Map<Pair<Integer, Integer>, BaselearnerDataset> baseLearnerDatasets = getBaselearnerDatasets(labelRankingDataset, labels);
      List<IDataset<double[], NullType, Double>> results = new ArrayList<>();
      results.add(baseLearnerDatasets.get(Pair.of(labels[0], labels[1])));
      return results;
   }


   /**
    * Creates a {@link LabelRankingDataset} using the {@link LabelRankingDatasetParser} representing
    * the dtt.gprf dataset.
    * 
    * @return a {@link LabelRankingDataset} representing the dtt.gprf dataset
    * 
    * @throws ParsingFailedException if the parsing process of the {@link LabelRankingDataset} fails
    */
   private LabelRankingDataset getLabelRankingDataset() throws ParsingFailedException {
      LabelRankingDatasetParser labelRankingDatasetParser = new LabelRankingDatasetParser();
      labelRankingDatasetParser.parse(new DatasetFile(new File(getTestRessourcePathFor(LABEL_RANKING_SOURCE_DATASET_FILE_NAME))));
      LabelRankingDataset labelRankingDataset = (LabelRankingDataset) labelRankingDatasetParser.getDataset();
      return labelRankingDataset;
   }


   /**
    * Provides l(l-1)/2 {@link BaselearnerDataset}s for the preference learning models.
    *
    * @param labelRankingDataset the label ranking dataset
    * @param labels the labels of the rankings
    * 
    * @return the datasets for the rankings
    */
   private Map<Pair<Integer, Integer>, BaselearnerDataset> getBaselearnerDatasets(LabelRankingDataset labelRankingDataset, int[] labels) {
      Map<Pair<Integer, Integer>, BaselearnerDataset> baselearnerDatasets = new HashMap<>();

      for (int firstLabelIndex = 0; firstLabelIndex < labels.length; firstLabelIndex++) {

         int secondLabelIndex = firstLabelIndex + 1;
         while (secondLabelIndex < labels.length) {

            Pair<Integer, Integer> itemPair = Pair.of(labels[firstLabelIndex], labels[secondLabelIndex]);
            BaselearnerDataset baselearnerDataset = new BaselearnerDataset(labelRankingDataset.getNumberOfInstances(),
                  labelRankingDataset.getFeatureValuesOfAnInstance(0).length);

            for (int i = 0; i < labelRankingDataset.getNumberOfInstances(); i++) {
               double[] contextVector = labelRankingDataset.getFeatureValuesOfAnInstance(i);
               Ranking ranking = labelRankingDataset.getRankingOfInstance(i);
               int[] item = ranking.getOrderingForRanking();
               int firstLabelPreferedToSecondLabel = isItemPrefered(item, itemPair.getFirst(), itemPair.getSecond());
               baselearnerDataset.addFeatureVectorWithResult(contextVector, firstLabelPreferedToSecondLabel);
            }

            baselearnerDatasets.put(itemPair, baselearnerDataset);
            secondLabelIndex++;
         }
      }

      return baselearnerDatasets;

   }


   /**
    * Compares the preference between two provided ranking items.
    * 
    * @param items the label ranking items
    * @param rankItem the first rank item
    * @param compareRankItem the second rank item
    * 
    * @return the result for the {@link BaselearnerDataset} of the two rankItems
    */
   private int isItemPrefered(int[] items, int rankItem, int compareRankItem) {
      int indexRankItem = Integer.MAX_VALUE;
      int indexCompareRankItem = Integer.MAX_VALUE;
      for (int i = 0; i < items.length; i++) {
         int item = items[i];
         if (item == rankItem) {
            indexRankItem = i;
         }
         if (item == compareRankItem) {
            indexCompareRankItem = i;
         }
      }

      return indexRankItem < indexCompareRankItem ? 1 : -1;
   }


   /**
    * Makes sure that the logging is initialized correctly and the random number generator is
    * initialized with the same seed.
    */
   @Override
   @Before
   public void setupTest() {
      super.setupTest();
      LoggingConfiguration.setupLoggingConfiguration();
      RandomGenerator.getRNG().setSeed(RANDOM_SEED);
   }


   @Override
   protected boolean areDoublesEqual(double firstValue, double secondValue) {
      return TestUtils.areDoublesEqual(firstValue, secondValue, DOUBLE_DELTA);
   }

}
